<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FHE Eva Core v7.0 - Optimized Benchmarks</title>
    <style>
        :root {
            --bg: #0a0e17;
            --card: #131b2d;
            --accent: #00d4ff;
            --text: #e6f1ff;
            --success: #00ff9d;
            --warning: #ffb74d;
            --error: #ff6b6b;
        }
        
        body {
            background: var(--bg);
            color: var(--text);
            font-family: 'Segoe UI', system-ui, sans-serif;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--accent);
        }
        
        .device-badge {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-top: 10px;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: var(--card);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #2a3a5a;
            transition: transform 0.2s, border-color 0.2s;
        }
        
        .card:hover {
            transform: translateY(-2px);
            border-color: var(--accent);
        }
        
        .card-title {
            color: var(--accent);
            margin-top: 0;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-title svg {
            width: 20px;
            height: 20px;
        }
        
        button {
            background: linear-gradient(135deg, #00d4ff 0%, #0099ff 100%);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1em;
            cursor: pointer;
            width: 100%;
            margin: 8px 0;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.4);
        }
        
        button:disabled {
            background: #2a3a5a;
            cursor: not-allowed;
            opacity: 0.5;
        }
        
        button.ultra {
            background: linear-gradient(135deg, #ff0080 0%, #ff8c00 100%);
        }
        
        button.ultra:hover:not(:disabled) {
            box-shadow: 0 5px 15px rgba(255, 0, 128, 0.4);
        }
        
        #terminal {
            background: #0c1424;
            color: var(--text);
            font-family: 'Consolas', 'Monaco', monospace;
            padding: 20px;
            border-radius: 8px;
            height: 300px;
            overflow-y: auto;
            border: 1px solid #2a3a5a;
            margin-top: 20px;
            font-size: 0.9em;
        }
        
        .log-entry {
            margin: 5px 0;
            padding: 8px 12px;
            border-left: 3px solid transparent;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }
        
        .log-entry.success {
            border-left-color: var(--success);
            color: var(--success);
        }
        
        .log-entry.warning {
            border-left-color: var(--warning);
            color: var(--warning);
        }
        
        .log-entry.error {
            border-left-color: var(--error);
            color: var(--error);
        }
        
        .log-entry.info {
            border-left-color: var(--accent);
            color: var(--accent);
        }
        
        .timestamp {
            color: #8b9dc3;
            font-size: 0.8em;
            margin-right: 10px;
        }
        
        .results-panel {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid var(--accent);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
        }
        
        .result-label {
            font-weight: 500;
        }
        
        .result-value {
            font-weight: 600;
            color: var(--accent);
        }
        
        .visualization {
            display: grid;
            grid-template-columns: repeat(16, 1fr);
            gap: 2px;
            margin-top: 15px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
        }
        
        .viz-cell {
            aspect-ratio: 1;
            background: #1a2338;
            border-radius: 2px;
            transition: background 0.3s;
        }
        
        .progress-bar {
            height: 6px;
            background: #2a3a5a;
            border-radius: 3px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00d4ff, #0099ff);
            width: 0%;
            transition: width 0.5s;
        }
        
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            
            .visualization {
                grid-template-columns: repeat(8, 1fr);
            }
        }
        
        .spinner {
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent);
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-right: 8px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ FHE Eva Core v7.0</h1>
            <div class="device-badge">S23 Ultra ‚Ä¢ SD 8 Gen 2 ‚Ä¢ Adreno 740</div>
            <p>Radix-4 NTT + Montgomery Optimized Benchmarks</p>
        </div>
        
        <div class="grid">
            <!-- Original Benchmarks -->
            <div class="card">
                <h2 class="card-title">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
                    </svg>
                    Original Benchmarks
                </h2>
                <p style="color: #8b9dc3; font-size: 0.9em;">Deine urspr√ºngliche Radix-2 Implementierung</p>
                
                <button id="btn-original-ntt" onclick="runOriginalNTT()">
                    üèÉ NTT-1024 Benchmark
                </button>
                
                <button id="btn-original-memory" onclick="runOriginalMemory()">
                    üíæ Memory Bandwidth Test
                </button>
            </div>
            
            <!-- Optimized Benchmarks -->
            <div class="card">
                <h2 class="card-title">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M13 2.05v2.02c3.95.49 7 3.85 7 7.93 0 3.21-1.92 6-4.72 7.28L13 17v5h5l-1.22-1.22C19.91 19.07 22 15.76 22 12c0-5.18-3.95-9.45-9-9.95zM11 2c-1.95.2-3.8.96-5.32 2.21L7.1 5.63A8.195 8.195 0 0111 4V2zM4.2 5.68C2.96 7.2 2.2 9.05 2 11h2c.19-1.42.75-2.77 1.63-3.9L4.2 5.68zM2 13c.2 1.95.97 3.8 2.21 5.32l1.42-1.42A8.21 8.21 0 014 13H2zm5.11 5.37l-1.43 1.42A10.04 10.04 0 0011 22v-2a8.063 8.063 0 01-3.89-1.63z"/>
                    </svg>
                    Optimized Benchmarks
                </h2>
                <p style="color: #8b9dc3; font-size: 0.9em;">Radix-4 + Montgomery f√ºr S23 Ultra</p>
                
                <button class="ultra" id="btn-ultra-ntt" onclick="runUltraNTT()">
                    ‚ö° ULTRA NTT-4096
                </button>
                
                <button class="ultra" id="btn-ultra-memory" onclick="runUltraMemory()">
                    üöÄ Optimized Memory BW
                </button>
                
                <button class="ultra" id="btn-comparison" onclick="runComparison()">
                    üìä Compare Old vs New
                </button>
                
                <button class="ultra" id="btn-all-benchmarks" onclick="runAllBenchmarks()">
                    üéØ Run All Benchmarks
                </button>
            </div>
            
            <!-- Results Visualization -->
            <div class="card">
                <h2 class="card-title">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
                    </svg>
                    Live Results
                </h2>
                
                <div id="results-container" class="hidden">
                    <div class="result-item">
                        <span class="result-label">NTT-4096 Time:</span>
                        <span id="result-ntt" class="result-value">-- ms</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Memory Bandwidth:</span>
                        <span id="result-memory" class="result-value">-- GB/s</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Speedup Factor:</span>
                        <span id="result-speedup" class="result-value">-- x</span>
                    </div>
                    
                    <div class="progress-bar">
                        <div id="progress-fill" class="progress-fill"></div>
                    </div>
                </div>
                
                <div class="visualization" id="viz-grid">
                    <!-- Visualization cells will be generated by JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- Results Panel -->
        <div id="results-panel" class="results-panel hidden">
            <h3 style="margin-top: 0;">üìà Benchmark Results</h3>
            <div id="detailed-results"></div>
        </div>
        
        <!-- Terminal Output -->
        <div class="card">
            <h2 class="card-title">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 9h12v2H6V9zm8 5H6v-2h8v2zm4-6H6V6h12v2z"/>
                </svg>
                System Console
            </h2>
            
            <div id="terminal"></div>
            
            <div style="margin-top: 15px; display: flex; gap: 10px;">
                <button onclick="clearConsole()" style="background: #2a3a5a; flex: 1;">
                    üßπ Clear Console
                </button>
                <button onclick="exportResults()" style="background: #4CAF50; flex: 1;">
                    üì• Export Results
                </button>
            </div>
        </div>
        
        <!-- Status Indicator -->
        <div style="text-align: center; margin-top: 30px; padding: 15px; background: rgba(0, 0, 0, 0.2); border-radius: 8px;">
            <div id="status-indicator">
                <span class="spinner"></span>
                <span id="status-text">Loading WebAssembly module...</span>
            </div>
        </div>
    </div>

    <script type="module">
        // Import WebAssembly Module
        import init, { 
            ntt_1024, 
            memory_bandwidth_test,
            ntt_4096_ultrafast,
            memory_bandwidth_test_optimized,
            benchmark_ntt_comparison,
            run_all_benchmarks,
            UltraFheContext,
            init_fhe_mobile
        } from './wasm/fhe_eva_core.js';
        
        // Global State
        let wasmModule = null;
        let isInitialized = false;
        let currentTest = null;
        let benchmarkResults = {
            original_ntt: null,
            original_memory: null,
            ultra_ntt: null,
            ultra_memory: null,
            comparison: null
        };
        
        // DOM Elements
        const terminal = document.getElementById('terminal');
        const statusText = document.getElementById('status-text');
        const statusIndicator = document.getElementById('status-indicator');
        const resultsContainer = document.getElementById('results-container');
        const resultsPanel = document.getElementById('results-panel');
        const detailedResults = document.getElementById('detailed-results');
        const vizGrid = document.getElementById('viz-grid');
        
        // Initialize visualization grid
        function initVisualization() {
            vizGrid.innerHTML = '';
            for (let i = 0; i < 256; i++) {
                const cell = document.createElement('div');
                cell.className = 'viz-cell';
                cell.id = `viz-cell-${i}`;
                vizGrid.appendChild(cell);
            }
        }
        
        // Update visualization
        function updateVisualization(ctx = null) {
            if (!ctx) return;
            
            try {
                for (let i = 0; i < 256; i++) {
                    const cell = document.getElementById(`viz-cell-${i}`);
                    if (cell) {
                        const value = ctx.get_coeff(i) || 0;
                        const intensity = Math.min(value / 1000000, 1);
                        cell.style.background = `rgba(0, 212, 255, ${0.1 + intensity * 0.9})`;
                    }
                }
            } catch (e) {
                // Silently fail if visualization fails
            }
        }
        
        // Logging function
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString([], { 
                hour: '2-digit', 
                minute: '2-digit',
                second: '2-digit' 
            });
            
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.innerHTML = `<span class="timestamp">[${timestamp}]</span> ${message}`;
            
            terminal.appendChild(entry);
            terminal.scrollTop = terminal.scrollHeight;
        }
        
        // Clear console
        function clearConsole() {
            terminal.innerHTML = '';
            log("Console cleared", "info");
        }
        
        // Update progress bar
        function updateProgress(percent) {
            const progressFill = document.getElementById('progress-fill');
            if (progressFill) {
                progressFill.style.width = `${percent}%`;
            }
        }
        
        // Show results
        function showResult(id, value, unit = '') {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = `${value}${unit}`;
            }
        }
        
        // Show results panel
        function showResultsPanel(content) {
            detailedResults.innerHTML = content;
            resultsPanel.classList.remove('hidden');
            resultsContainer.classList.remove('hidden');
        }
        
        // Disable all buttons during test
        function disableButtons(disable = true) {
            const buttons = document.querySelectorAll('button');
            buttons.forEach(btn => {
                if (!btn.id.includes('clear') && !btn.id.includes('export')) {
                    btn.disabled = disable;
                }
            });
        }
        
        // Run Original NTT
        async function runOriginalNTT() {
            if (!isInitialized || !wasmModule) {
                log("WASM module not loaded", "error");
                return;
            }
            
            currentTest = 'original_ntt';
            disableButtons(true);
            
            log("Starting Original NTT-1024 Benchmark...", "warning");
            updateProgress(30);
            
            try {
                const startTime = performance.now();
                const result = wasmModule.ntt_1024();
                const endTime = performance.now();
                
                const measuredTime = (endTime - startTime).toFixed(2);
                
                benchmarkResults.original_ntt = result;
                showResult('result-ntt', measuredTime, ' ms');
                
                log(`‚úÖ Original NTT-1024: ${result}ms (WASM) / ${measuredTime}ms (JS)`, "success");
                updateProgress(100);
                
            } catch (e) {
                log(`‚ùå Error: ${e.message}`, "error");
            } finally {
                disableButtons(false);
                setTimeout(() => updateProgress(0), 1000);
            }
        }
        
        // Run Original Memory Test
        async function runOriginalMemory() {
            if (!isInitialized || !wasmModule) {
                log("WASM module not loaded", "error");
                return;
            }
            
            currentTest = 'original_memory';
            disableButtons(true);
            
            log("Starting Original Memory Bandwidth Test...", "warning");
            updateProgress(30);
            
            try {
                const result = wasmModule.memory_bandwidth_test();
                
                benchmarkResults.original_memory = result;
                showResult('result-memory', result.toFixed(2), ' GB/s');
                
                log(`‚úÖ Original Memory Bandwidth: ${result.toFixed(2)} GB/s`, "success");
                updateProgress(100);
                
            } catch (e) {
                log(`‚ùå Error: ${e.message}`, "error");
            } finally {
                disableButtons(false);
                setTimeout(() => updateProgress(0), 1000);
            }
        }
        
        // Run Ultra NTT
        async function runUltraNTT() {
            if (!isInitialized || !wasmModule) {
                log("WASM module not loaded", "error");
                return;
            }
            
            currentTest = 'ultra_ntt';
            disableButtons(true);
            
            log("üöÄ Starting ULTRA NTT-4096 Benchmark (Radix-4)...", "info");
            updateProgress(20);
            
            try {
                // Initialize mobile context
                if (wasmModule.init_fhe_mobile) {
                    wasmModule.init_fhe_mobile(4096, 0x7fffffffe0001, 65537);
                    log("Mobile context initialized", "info");
                    updateProgress(40);
                }
                
                const startTime = performance.now();
                const result = wasmModule.ntt_4096_ultrafast();
                const endTime = performance.now();
                
                const measuredTime = (endTime - startTime).toFixed(2);
                
                benchmarkResults.ultra_ntt = result;
                showResult('result-ntt', result.toFixed(2), ' ms');
                
                // Create UltraFheContext for visualization
                try {
                    const ctx = new wasmModule.UltraFheContext(4096);
                    ctx.generate_keys();
                    ctx.ntt_ultrafast();
                    updateVisualization(ctx);
                } catch (e) {
                    // If UltraFheContext not available, continue
                }
                
                // Compare with your screenshot result (2.5ms)
                const yourBest = 2.5;
                if (result < yourBest) {
                    const improvement = ((yourBest - result) / yourBest * 100).toFixed(1);
                    log(`üéâ ULTRA NTT-4096: ${result.toFixed(2)}ms (${improvement}% faster than your ${yourBest}ms!)`, "success");
                    showResult('result-speedup', `${improvement}%`, ' faster');
                } else {
                    log(`‚úÖ ULTRA NTT-4096: ${result.toFixed(2)}ms`, "success");
                }
                
                updateProgress(100);
                
            } catch (e) {
                log(`‚ùå Error in ULTRA NTT: ${e.message}`, "error");
                log("Note: Optimized functions might not be compiled yet.", "warning");
                log("Compile with: wasm-pack build --target web --release", "warning");
            } finally {
                disableButtons(false);
                setTimeout(() => updateProgress(0), 1000);
            }
        }
        
        // Run Ultra Memory Test
        async function runUltraMemory() {
            if (!isInitialized || !wasmModule) {
                log("WASM module not loaded", "error");
                return;
            }
            
            currentTest = 'ultra_memory';
            disableButtons(true);
            
            log("üöÄ Starting Optimized Memory Bandwidth Test...", "info");
            updateProgress(30);
            
            try {
                const result = wasmModule.memory_bandwidth_test_optimized 
                    ? wasmModule.memory_bandwidth_test_optimized()
                    : wasmModule.memory_bandwidth_test();
                
                benchmarkResults.ultra_memory = result;
                showResult('result-memory', result.toFixed(2), ' GB/s');
                
                // Compare with your screenshot result (9.8 GB/s)
                const yourBest = 9.8;
                if (result > yourBest) {
                    const improvement = ((result - yourBest) / yourBest * 100).toFixed(1);
                    log(`üéâ Optimized Memory BW: ${result.toFixed(2)} GB/s (${improvement}% better than your ${yourBest} GB/s!)`, "success");
                } else {
                    log(`‚úÖ Optimized Memory BW: ${result.toFixed(2)} GB/s`, "success");
                }
                
                updateProgress(100);
                
            } catch (e) {
                log(`‚ùå Error: ${e.message}`, "error");
            } finally {
                disableButtons(false);
                setTimeout(() => updateProgress(0), 1000);
            }
        }
        
        // Run Comparison
        async function runComparison() {
            if (!isInitialized || !wasmModule) {
                log("WASM module not loaded", "error");
                return;
            }
            
            currentTest = 'comparison';
            disableButtons(true);
            
            log("üìä Starting NTT Comparison Benchmark...", "info");
            updateProgress(20);
            
            try {
                const result = wasmModule.benchmark_ntt_comparison
                    ? wasmModule.benchmark_ntt_comparison()
                    : "Comparison function not available";
                
                benchmarkResults.comparison = result;
                
                // Display results nicely
                showResultsPanel(`
                    <div style="white-space: pre-line; font-family: monospace; background: rgba(0,0,0,0.3); padding: 15px; border-radius: 6px;">
                        ${result}
                    </div>
                    <div style="margin-top: 20px;">
                        <h4>Interpretation:</h4>
                        <ul>
                            <li><strong>Normalized speedup</strong> compares performance per polynomial element</li>
                            <li>Radix-4 should be 2-4x faster than Radix-2</li>
                            <li>Montgomery multiplication adds another 30-50% speedup</li>
                        </ul>
                    </div>
                `);
                
                log("‚úÖ Comparison benchmark completed", "success");
                updateProgress(100);
                
            } catch (e) {
                log(`‚ùå Error: ${e.message}`, "error");
                showResultsPanel(`
                    <div style="color: var(--error);">
                        <p>Comparison failed: ${e.message}</p>
                        <p>Make sure optimized functions are compiled.</p>
                    </div>
                `);
            } finally {
                disableButtons(false);
                setTimeout(() => updateProgress(0), 1000);
            }
        }
        
        // Run All Benchmarks
        async function runAllBenchmarks() {
            if (!isInitialized || !wasmModule) {
                log("WASM module not loaded", "error");
                return;
            }
            
            disableButtons(true);
            
            log("üéØ Starting Complete Benchmark Suite...", "info");
            
            try {
                updateProgress(10);
                await runUltraMemory();
                
                updateProgress(30);
                await runUltraNTT();
                
                updateProgress(60);
                await runComparison();
                
                updateProgress(80);
                
                // Run comprehensive benchmark if available
                if (wasmModule.run_all_benchmarks) {
                    log("Running comprehensive benchmark...", "info");
                    const result = wasmModule.run_all_benchmarks();
                    showResultsPanel(`
                        <div style="white-space: pre-line; font-family: monospace; background: rgba(0,0,0,0.3); padding: 15px; border-radius: 6px;">
                            ${result}
                        </div>
                        <div style="margin-top: 20px;">
                            <h4>S23 Ultra Performance Assessment:</h4>
                            <ul>
                                <li>‚úÖ Radix-4 reduces NTT stages from 12 to 6</li>
                                <li>‚úÖ Montgomery multiplication faster than standard mod</li>
                                <li>‚úÖ Precomputed tables eliminate redundant calculations</li>
                                <li>üéØ Target: NTT-4096 < 2ms, Memory BW > 10 GB/s</li>
                            </ul>
                        </div>
                    `);
                }
                
                updateProgress(100);
                log("‚úÖ All benchmarks completed successfully!", "success");
                
            } catch (e) {
                log(`‚ùå Error in benchmark suite: ${e.message}`, "error");
            } finally {
                disableButtons(false);
                setTimeout(() => updateProgress(0), 1000);
            }
        }
        
        // Export results
        function exportResults() {
            const data = {
                timestamp: new Date().toISOString(),
                device: "Samsung Galaxy S23 Ultra (SD 8 Gen 2)",
                benchmarks: benchmarkResults
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `fhe-benchmark-${Date.now()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            log("Results exported as JSON", "success");
        }
        
        // Initialize the application
        async function initializeApp() {
            try {
                log("Loading WebAssembly module...", "info");
                
                // Try to load the WASM module
                await init();
                wasmModule = await import('./wasm/fhe_eva_core.js');
                
                // Update status
                statusIndicator.innerHTML = '<span style="color: var(--success);">‚úì</span>';
                statusText.textContent = "WebAssembly module loaded successfully";
                statusText.style.color = "var(--success)";
                
                isInitialized = true;
                log("‚úÖ FHE Eva Core v7.0 initialized", "success");
                log("Device: S23 Ultra ‚Ä¢ Snapdragon 8 Gen 2 ‚Ä¢ Adreno 740", "info");
                log("Ready for optimized benchmarks (Radix-4 + Montgomery)", "info");
                
                // Initialize visualization
                initVisualization();
                
                // Check which functions are available
                const availableFunctions = [];
                if (wasmModule.ntt_4096_ultrafast) availableFunctions.push("ntt_4096_ultrafast");
                if (wasmModule.UltraFheContext) availableFunctions.push("UltraFheContext");
                if (wasmModule.init_fhe_mobile) availableFunctions.push("init_fhe_mobile");
                
                if (availableFunctions.length > 0) {
                    log(`Optimized functions available: ${availableFunctions.join(', ')}`, "success");
                } else {
                    log("‚ö†Ô∏è Optimized functions not found - compile with: wasm-pack build --target web --release", "warning");
                }
                
            } catch (e) {
                statusIndicator.innerHTML = '<span style="color: var(--error);">‚úó</span>';
                statusText.textContent = "Failed to load WebAssembly module";
                statusText.style.color = "var(--error)";
                
                log(`‚ùå Fatal error: ${e.message}`, "error");
                log("Possible issues:", "error");
                log("1. wasm/fhe_eva_core.js file not found", "error");
                log("2. WebAssembly not compiled (run: wasm-pack build --target web --release)", "error");
                log("3. Incorrect import path", "error");
                
                // Disable all benchmark buttons
                disableButtons(true);
            }
        }
        
        // Make functions available globally
        window.runOriginalNTT = runOriginalNTT;
        window.runOriginalMemory = runOriginalMemory;
        window.runUltraNTT = runUltraNTT;
        window.runUltraMemory = runUltraMemory;
        window.runComparison = runComparison;
        window.runAllBenchmarks = runAllBenchmarks;
        window.clearConsole = clearConsole;
        window.exportResults = exportResults;
        
        // Start the application
        initializeApp();
    </script>
</body>
  </html>
